@using TestProject.Extentions@model PaginatedList<TestProject.Models.Trip>@{    ViewData["Title"] = "Пътешествия";}<div class="container">    <div class="page-header">        <h1>            @if (!string.IsNullOrEmpty(ViewBag.DriverName))            {                <span>Пътешествия от @ViewBag.DriverName @* - @ViewBag.TripCount *@</span>            }            else            {                <span>Пътешествия @* - @ViewBag.TripCount *@</span>            }        </h1>        @if (!string.IsNullOrEmpty(ViewBag.ReturnUrl) && Url.IsLocalUrl(ViewBag.ReturnUrl))
        {            <a href="@ViewBag.ReturnUrl" class="btn btn-secondary">                <i class="fas fa-arrow-left"></i> Върни се обратно            </a>        }
        else
        {            @if (User.IsInRole("Driver"))
            {                <a asp-action="Create" asp-route-returnUrl="@Context.Request.Path" class="create-trip-btn">                    <i class="fas fa-plus-circle"></i> Създай ново пътешествие                </a>            }
            else
            {                <a href="/Identity/Account/Manage" class="create-trip-btn">                    <i class="fas fa-id-card"></i> Стани Шофьор                </a>            }        }    </div>    <div class="search-form">        <div class="search-form-header">            <h2 class="search-form-title" style="margin-top: -20px;">Търсене и филтриране </h2>            <div class="form-group" style="min-width: 200px; margin-left: 10px;">                <form asp-action="Index" method="get" id="sortForm">                    <input type="hidden" name="startPosition" value="@ViewBag.CurrentStartPosition" />                    <input type="hidden" name="destination" value="@ViewBag.CurrentDestination" />                    <input type="hidden" name="driverId" value="@ViewBag.CurrentDriverId" />                    <input type="hidden" name="returnUrl" value="@ViewBag.ReturnUrl" />                    <select name="sortOrder" asp-items="@(new SelectList(ViewBag.SortOptions as IEnumerable<SelectListItem>, "Value", "Text", ViewBag.CurrentSortOrder))"                         onchange="this.form.submit()" class="form-control">                    </select>                </form>            </div>        </div>        <form asp-action="Index" method="get" id="tripSearchForm">            <input type="hidden" name="returnUrl" value="@ViewBag.ReturnUrl" />            <input type="hidden" name="sortOrder" value="@ViewBag.CurrentSortOrder" />            <div class="search-form-row" style="margin-bottom: -5px;">                <div class="form-group">                    <label>Стартираща позиция:</label>                    <input type="text" name="startPosition" value="@ViewBag.CurrentStartPosition" class="form-control" placeholder="Въведете начална позиция" />                </div>                <div class="form-group">                    <label>Дестинация:</label>                    <input type="text" name="destination" value="@ViewBag.CurrentDestination" class="form-control" placeholder="Въведете дестинация" />                </div>                <div class="search-buttons" style="padding-bottom: 16px">                    <button type="submit" class="btn btn-primary">                        <i class="fas fa-search"></i> Потърси                    </button>                    <button type="button" class="btn btn-secondary" onclick="clearSearch()">                        <i class="fas fa-times"></i> Изчисти                    </button>                </div>            </div>        </form>    </div>    @if (!Model.Any())
    {        <div class="empty-state">            <i class="fas fa-clipboard-check"></i>            <p>Няма намерени пътешествия в този момент.</p>        </div>    }
    else
    {        <partial name="_TripTablePartial" model="Model" />        <partial name="_PaginationPartial" model="Model" />    }</div>@section Scripts {    <script>        function clearSearch() {            $('input[name=startPosition]').val('');            $('input[name=destination]').val('');            document.getElementById("tripSearchForm").submit();        }    </script>}